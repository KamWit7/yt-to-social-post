## Plan techniczny (frontend): dostosowanie do zmian z 0001_PLAN.md

Kontekst: Backend uprościł body endpointu AI (usunięto `options`, dodano `customPrompt?` i `model?` z domyślnym `"gemini-2.5-pro"`). Frontend musi zaktualizować typy, formularz `PurposeForm`, walidację oraz requesty do API, tak aby nie wysyłać `options` i umożliwić wybór modelu.

### Pliki do zmiany

- `yt-scribe/src/types/index.ts`
- `yt-scribe/src/api/services/aiProcessingService.ts`
- `yt-scribe/src/api/hooks/useAIProcessing.ts`
- `yt-scribe/src/components/dashboard/TranscriptionForms/constants/formConstants.ts`
- `yt-scribe/src/components/dashboard/TranscriptionForms/forms/PurposeForm/purposeSchema.ts`
- `yt-scribe/src/components/dashboard/TranscriptionForms/forms/PurposeForm/PurposeForm.helpers.ts`
- `yt-scribe/src/components/dashboard/TranscriptionForms/forms/PurposeForm/ConditionalOptions.tsx`
- `yt-scribe/src/components/dashboard/TranscriptionForms/forms/PurposeForm/PurposeForm.tsx`
- (opcjonalnie) nowy komponent wyboru modelu w `PurposeForm/` lub wspólny w `components/common/form`

### Zmiany szczegółowe

- Typy (`yt-scribe/src/types/index.ts`)

  - Zmień `AIProcessingRequest`:
    - Usuń `options`.
    - Dodaj `customPrompt?: string`.
    - Dodaj `model?: 'gemini-2.5-pro' | 'gemini-2.5-flash' | 'gemini-2.5-flash-lite'`.
  - `AIProcessingResponse` bez zmian.

- Serwis API (`yt-scribe/src/api/services/aiProcessingService.ts`)

  - Interfejs wejścia korzysta z `AIProcessingRequest`; po zmianie typu body wyśle nowy kształt.
  - Nie zmieniaj `processWithAI` poza dopasowaniem importów (jeśli to konieczne).

- Hook (`yt-scribe/src/api/hooks/useAIProcessing.ts`)

  - Bez zmian logiki; parametry i typy aktualizują się przez `AIProcessingRequest`.

- Stałe formularza (`formConstants.ts`)

  - Zmień `FORM_FIELD_NAMES`:
    - Usuń: `FORM_FIELD_NAMES.GENERATE_MIND_MAP`, `FORM_FIELD_NAMES.GENERATE_SOCIAL_POST` oraz wszystkie inne `options.*`.
    - Dodaj: `CUSTOM_PROMPT: 'customPrompt'`, `MODEL: 'model'`.
  - Zmień `DEFAULT_VALUES`:
    - Usuń obiekt `options`.
    - Dodaj `customPrompt: ''`.
    - Dodaj `model: 'gemini-2.5-pro'` (spójny z domyślnym backendu).

- Walidacja (`purposeSchema.ts`)

  - Usuń gałąź `options` i związane z nią pola.
  - Pola i reguły:
    - `purpose`: `z.string().min(1, ...)`.
    - `customPurpose?`: jak dotychczas (wymagane, gdy `purpose === 'Inny'`).
    - `customPrompt?`: `z.string().trim().min(1).optional()`; jeśli `purpose === 'custom'` to pole wymagane (refine po `trim()`).
    - `model?`: `z.enum(['gemini-2.5-pro','gemini-2.5-flash','gemini-2.5-flash-lite']).default('gemini-2.5-pro')`.
  - Usuń `.refine` odnoszący się do `options.customPrompt`.

- Domyślne wartości (`PurposeForm.helpers.ts`)

  - Usuń `options`.
  - Dodaj `customPrompt: ''`, `model: 'gemini-2.5-pro'`.

- UI warunkowe (`ConditionalOptions.tsx`)

  - Usuń checkboxy oraz referencje do:
    - `FORM_FIELD_NAMES.GENERATE_MIND_MAP`
    - `FORM_FIELD_NAMES.GENERATE_SOCIAL_POST`
  - Sekcja `custom` ma używać `FORM_FIELD_NAMES.CUSTOM_PROMPT` (bez `options.`).
  - Opcje generowania (mind map/social post) nie są już sterowane checkboxami – backend wybiera na podstawie `purpose`.

- Wybór modelu (UI)
a
  - Dodaj kontrolkę wyboru modelu (np. `ControlledSelect`) w `PurposeForm` z opcjami:
    - `gemini-2.5-pro`
    - `gemini-2.5-flash`
    - `gemini-2.5-flash-lite`
  - `name`: `FORM_FIELD_NAMES.MODEL`.
  - Domyślna wartość: `'gemini-2.5-pro'`.

- Główny formularz (`PurposeForm.tsx`)
  - W `onFormSubmit` buduj body bez `options`:
    - `transcript`, `purpose`, `customPurpose` – bez zmian.
    - `customPrompt: data.customPrompt || undefined` (po `trim` puste traktuj jako brak).
    - `model: data.model` (można polegać na domyślnej wartości z walidacji).
  - Usuń przekazywanie `options: data.options` i wszystkie referencje do `options.*`.

### Zachowanie po zmianie

- Backend generuje treści w zależności od `purpose`; frontend nie wysyła już flag generowania.
- Dla `purpose = 'custom'` wymagany `customPrompt`.
- Użytkownik może wybrać model; brak wyboru → domyślnie `gemini-2.5-pro`.

### Kroki wdrożenia

1. Zaktualizuj `AIProcessingRequest` w `types/index.ts` (usuń `options`, dodaj `customPrompt?`, `model?`).
2. Zmień `formConstants.ts` (usuń `FORM_FIELD_NAMES.GENERATE_MIND_MAP`, `FORM_FIELD_NAMES.GENERATE_SOCIAL_POST`, cały `options.*`; dodaj `CUSTOM_PROMPT`, `MODEL`; popraw `DEFAULT_VALUES`).
3. Zaktualizuj `purposeSchema.ts` (walidacja `customPrompt` i `model`, usuń `options`).
4. Zmień `PurposeForm.helpers.ts` (usuń `options`, dodaj `customPrompt`, `model`).
5. Zmodyfikuj `ConditionalOptions.tsx` (usuń checkboxy `mind map`/`social post`, zostaw `customPrompt`) ale nie usuwaj całej sekcji zmień  Opcje dla social media na Wygeneruj post na social media i analogicznie dla mind map.
6. Dodaj selektor modelu w `PurposeForm` i zaktualizuj `onFormSubmit` (bez `options`).
7. Upewnij się, że `useAIProcessing.ts` i `aiProcessingService.ts` korzystają z nowego `AIProcessingRequest` oraz nie oczekują `options`.
8. Szybki QA: każdy `purpose` + 3 modele + przypadek bez `model` (domyślne).
