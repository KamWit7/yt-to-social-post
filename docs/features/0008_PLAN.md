# Feature Plan: Usage Counter Display in Dashboard Header

## Context

Add a usage counter display in the dashboard header that shows current usage in numerical format (e.g., "1/10") for authenticated users. The counter should include a tooltip with information about free plan limits and redirect to the usage page when clicked. This feature enhances user awareness of their usage limits and provides quick access to detailed usage statistics.

## Technical Requirements

- **Display Format**: Numerical format showing "current/limit" (e.g., "1/10")
- **Visibility**: Only visible to authenticated users
- **Tooltip**: Shows information about free plan limits with Polish text
- **Click Action**: Redirects to `/usage` page
- **Integration**: Seamlessly integrated into existing header design
- **Real-time Updates**: Reflects current usage state
- **Responsive Design**: Works across all device sizes

## Files and Functions to Modify/Create

### Phase 1: Core Components

#### New Component: Usage Counter (src/components/common/header/UsageCounter.tsx)

- Create usage counter component with tooltip integration
- Implement click handler for navigation to usage page
- Apply advanced UX enhancements for visual appeal
- Include loading states and error handling
- Integrate with existing header styling system

#### Modified Component: AuthSection (src/components/common/header/AuthSection.tsx)

- Add UsageCounter component next to UserMenu for authenticated users
- Maintain existing layout and spacing
- Ensure proper responsive behavior

#### New Hook: useUsageCounter (src/hooks/useUsageCounter.ts)

- Custom hook for fetching and managing usage data
- Handle loading states and error conditions
- Provide real-time usage updates
- Cache usage data for performance

### Phase 2: Enhanced UX Implementation

#### Tooltip Enhancement (src/components/ui/tooltip.tsx)

- Leverage existing tooltip component
- Apply advanced design principles for better visual hierarchy
- Implement micro-interactions for engagement

#### Visual Design Enhancements

- Apply 60-30-10 color rule with existing purple gradient branding
- Implement subtle animations and hover states
- Use typography hierarchy for clear information display
- Add depth through layering and elevation effects
- Optimize for both light and dark modes

### Phase 3: Integration and Routing

#### Constants Update (src/utils/constants.ts)

- Add tooltip text constants in Polish
- Define usage counter styling constants
- Add animation duration constants

#### Usage Stats Integration (src/lib/usage.ts)

- Ensure getUserUsageStats function is optimized for header usage
- Add caching mechanism if needed
- Maintain consistency with existing usage page

## Implementation Algorithm

### Usage Counter Display Logic

1. Check user authentication status via useSession
2. If authenticated → fetch usage data via useUsageCounter hook
3. Display counter in format "current/limit" with visual styling
4. Apply warning colors based on usage percentage (safe/warning/danger)
5. Show loading skeleton while data is being fetched

### Tooltip Implementation

1. Wrap counter in Tooltip component from existing UI library
2. Display Polish text: "Kliknij aby dowiedzieć się więcej o swoich limitach. W darmowym planie dostępne są 10 zapytań"
3. Apply advanced UX principles:
   - Strategic use of negative space
   - Color psychology for trust-building
   - Micro-interactions for engagement
   - Progressive disclosure of information

### Click Navigation

1. Implement onClick handler using Next.js router
2. Navigate to ROUTES.USAGE (/usage)
3. Add subtle click animation for user feedback
4. Maintain accessibility standards

### Visual Enhancement Strategy

1. **Color Psychology**: Use green for safe usage, yellow for warning, red for danger
2. **Typography Pairing**: Combine existing font weights for visual hierarchy
3. **Micro-interactions**: Subtle hover effects and click animations
4. **Depth Creation**: Use shadows and elevation for visual prominence
5. **Responsive Design**: Ensure counter adapts to different screen sizes

## Advanced UX Enhancements

### Visual Hierarchy Optimization

- Use F-pattern layout principles for natural eye flow
- Apply golden ratio proportions for counter sizing
- Implement gestalt principles for visual grouping

### Psychological Impact Elements

- Trust-building through consistent visual language
- Attention-directing through strategic contrast
- Cognitive load reduction via clear numerical display
- Emotional response optimization through color choices

### Interactive Design Features

- Smooth transitions on hover and click states
- Progressive disclosure of detailed information via tooltip
- Visual feedback for all interactive states
- Accessibility-compliant focus indicators

## File Structure Changes

```
src/
├── components/
│   └── common/
│       └── header/
│           ├── UsageCounter.tsx (NEW)
│           └── AuthSection.tsx (MODIFIED)
├── hooks/
│   └── useUsageCounter.ts (NEW)
└── utils/
    └── constants.ts (MODIFIED - add tooltip text)
```

## Integration Points

### Existing Components to Leverage

- **Tooltip Component**: Use existing tooltip.tsx for consistent styling
- **Usage Stats Logic**: Reuse getUserUsageStats from usage.ts
- **Authentication**: Integrate with existing useSession from AuthSection
- **Routing**: Use existing ROUTES constants and Next.js navigation

### Design System Integration

- Maintain consistency with existing purple gradient branding
- Follow established spacing and typography patterns
- Respect existing dark/light mode implementations
- Align with current button and interactive element styles

## Performance Considerations

- Implement usage data caching to minimize API calls
- Use React.memo for counter component optimization
- Lazy load usage data only when user is authenticated
- Optimize tooltip rendering with proper event handling

## Accessibility Standards

- Ensure proper ARIA labels for screen readers
- Maintain keyboard navigation support
- Provide sufficient color contrast ratios
- Include focus indicators for interactive elements
